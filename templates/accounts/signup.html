<!-- templates/accounts/signup.html - OPTIMIZED WITH REAL CLIENT LOGOS -->
{% extends 'base.html' %}
{% load static %}

{% block title %}Sign Up - Demo Portal{% endblock %}

{% block extra_css %}
<style>
    /* Font family applied globally */
    * {
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

    .signup-container {
        min-height: calc(100vh - 160px);
        padding: 0.75rem 0;
        background: linear-gradient(to bottom, #f8f9fa 0%, #ffffff 100%);
    }
    
    .signup-card {
        border: none;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        background: white;
    }
    
    /* Left Content Section Styles */
    .left-content-section {
        padding: 1.5rem;
        background: linear-gradient(135deg, #087fc2 0%, #0669a0 100%);
        color: white;
        border-radius: 15px;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
    }

    .left-content-section h1 {
        font-size: var(--font-2xl);
        font-weight: 700;
        margin-bottom: 0.5rem;
        font-family: Verdana, Geneva, Tahoma, sans-serif;
        line-height: 1.2;
    }

    .left-content-section h2 {
        font-size: var(--font-xl);
        font-weight: 600;
        margin-bottom: 0.5rem;
        margin-top: 1rem;
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

    .left-content-section h3 {
        font-size: var(--font-lg);
        font-weight: 600;
        margin-bottom: 0.75rem;
        margin-top: 1rem;
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

    .left-content-section p {
        font-size: var(--font-sm);
        margin-bottom: 0.75rem;
        line-height: 1.4;
        opacity: 0.95;
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

    .feature-list {
        list-style: none;
        padding: 0;
        margin: 0.75rem 0;
    }

    .feature-list li {
        padding: 0.4rem 0;
        font-size: var(--font-sm);
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

    .feature-list li i {
        width: 20px;
        height: 20px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: var(--font-xs);
        flex-shrink: 0;
    }

    /* Client Logos Section - REAL IMAGES SLIDER */
    .clients-section {
        margin: 1rem 0 0.5rem;
        padding: 1rem;
        background: white;
        border-radius: 12px;
        overflow: hidden;
    }

    .clients-section h3 {
        font-size: var(--font-md);
        font-weight: 600;
        margin-bottom: 0.75rem;
        margin-top: 0;
        text-align: center;
        font-family: Verdana, Geneva, Tahoma, sans-serif;
        color: #087fc2;
    }

    /* Slider Container */
    .client-logos-slider {
        position: relative;
        overflow: hidden;
        width: 100%;
        height: 80px;
        background: white;
    }

    .client-logos-track {
        display: flex;
        gap: 1.5rem;
        animation: slide 25s linear infinite;
        width: max-content;
        will-change: transform;
    }

    .client-logos-track:hover {
        animation-play-state: paused;
    }

    @keyframes slide {
        0% {
            transform: translateX(0);
        }
        100% {
            transform: translateX(-50%);
        }
    }

    .client-logo-item {
        background: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        min-width: 140px;
        height: 70px;
        transition: transform 0.3s, box-shadow 0.3s;
        flex-shrink: 0;
        border: 1px solid #e5e7eb;
    }

    .client-logo-item:hover {
        transform: translateY(-3px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    /* ✅ REAL CLIENT LOGO IMAGES */
    .client-logo-item img {
        max-width: 100%;
        max-height: 100%;
        width: auto;
        height: auto;
        object-fit: contain;
        display: block;
    }

    /* Looking For Section */
    .looking-for-section {
        margin: 0.75rem 0 0;
        padding: 1rem;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 12px;
    }

    .looking-for-section h3 {
        font-size: var(--font-md);
        font-weight: 600;
        margin-bottom: 0.75rem;
        margin-top: 0;
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

    .looking-for-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 0.625rem;
    }

    .looking-for-card {
        background: rgba(255, 255, 255, 0.95);
        padding: 0.75rem;
        border-radius: 8px;
        text-align: center;
        transition: all 0.3s;
        cursor: pointer;
        text-decoration: none;
        color: #2c3e50;
    }

    .looking-for-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        color: #087fc2;
    }

    .looking-for-card .icon-box {
        width: 40px;
        height: 40px;
        margin: 0 auto 0.5rem;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: var(--font-lg);
    }

    .looking-for-card .icon-box.red {
        background: rgba(220, 53, 69, 0.15);
        color: #dc3545;
    }

    .looking-for-card .icon-box.green {
        background: rgba(40, 167, 69, 0.15);
        color: #28a745;
    }

    .looking-for-card .icon-box.pink {
        background: rgba(232, 62, 140, 0.15);
        color: #e83e8c;
    }

    .looking-for-card .icon-box.blue {
        background: rgba(8, 127, 194, 0.15);
        color: #087fc2;
    }

    .looking-for-card h4 {
        font-size: var(--font-xs);
        font-weight: 600;
        margin: 0;
        font-family: Verdana, Geneva, Tahoma, sans-serif;
        line-height: 1.3;
    }

    /* Sales Contact Banner */
    .sales-banner {
        background: linear-gradient(135deg, #087fc2 0%, #0669a0 100%);
        color: white;
        padding: 1rem;
        border-radius: 12px;
        margin-bottom: 1rem;
        position: relative;
        overflow: hidden;
        box-shadow: 0 5px 20px rgba(8, 127, 194, 0.3);
        transition: opacity 0.3s ease, transform 0.3s ease;
    }
    
    .sales-banner::before {
        content: '';
        position: absolute;
        top: -50%;
        right: -10%;
        width: 200px;
        height: 200px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 50%;
    }
    
    .sales-banner.hiding {
        opacity: 0;
        transform: translateY(-20px);
    }
    
    .sales-banner.dismissed {
        display: none;
    }
    
    .sales-banner-content {
        position: relative;
        z-index: 1;
    }
    
    .sales-banner h5 {
        font-size: var(--font-md);
        font-weight: 700;
        margin-bottom: 0.4rem;
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }
    
    .sales-banner p {
        font-size: var(--font-xs);
        margin-bottom: 0.75rem;
        opacity: 0.95;
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }
    
    .sales-contact-info {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
        margin-top: 0.5rem;
    }
    
    .sales-contact-item {
        display: flex;
        align-items: center;
        gap: 0.4rem;
        font-size: var(--font-xs);
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }
    
    .sales-contact-item i {
        font-size: var(--font-sm);
        opacity: 0.9;
    }
    
    .btn-contact-sales {
        background: white;
        color: #087fc2;
        border: none;
        padding: 0.375rem 1rem;
        border-radius: 6px;
        font-weight: 600;
        font-size: var(--font-xs);
        transition: all 0.3s;
        display: inline-flex;
        align-items: center;
        gap: 0.4rem;
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }
    
    .btn-contact-sales:hover {
        background: #f8f9fa;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    
    /* Close button for sales banner */
    .btn-close-banner {
        position: absolute;
        top: 8px;
        right: 8px;
        background: rgba(255, 255, 255, 0.2);
        border: none;
        width: 26px;
        height: 26px;
        border-radius: 50%;
        color: white;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s;
        z-index: 10;
    }
    
    .btn-close-banner:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: rotate(90deg);
    }
    
    .btn-close-banner i {
        font-size: var(--font-xs);
    }
    
    /* Form Styles */
    .form-label {
        font-weight:500;
        color: #333;
        margin-bottom: 0.4rem;
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }
    
    .form-control, .form-select {
        font-size: var(--font-sm);
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }
    
    .form-control:focus, .form-select:focus {
        border-color: #087fc2;
        box-shadow: 0 0 0 0.2rem rgba(8, 127, 194, 0.15);
        outline: none;
    }
    
    /* Validation Styles */
    .invalid-feedback, .valid-feedback {
        display: none;
        margin-top: 0.25rem;
        font-size: var(--font-xs);
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }
    
    .form-control.is-invalid ~ .invalid-feedback,
    .form-select.is-invalid ~ .invalid-feedback,
    .form-check-input.is-invalid ~ .invalid-feedback {
        display: block;
        color: #dc3545;
    }
    
    .form-control.is-valid ~ .valid-feedback,
    .form-select.is-valid ~ .valid-feedback {
        display: block;
        color: #28a745;
    }
    
    .form-control.is-invalid, .form-select.is-invalid {
        border-color: #dc3545;
        background-image: none;
        background-repeat: no-repeat;
        background-position: right calc(0.375em + 0.1875rem) center;
        background-size: calc(0.75em + 0.375rem) calc(0.75em + 0.375rem);
    }
    
    .form-control.is-valid, .form-select.is-valid {
        border-color: #28a745;
        background-image: none;
        background-repeat: no-repeat;
        background-position: right calc(0.375em + 0.1875rem) center;
        background-size: calc(0.75em + 0.375rem) calc(0.75em + 0.375rem);
    }
    
    /* Remove validation icons from password fields */
    #password1.is-invalid,
    #password1.is-valid,
    #password2.is-invalid,
    #password2.is-valid {
        background-image: none !important;
        padding-right: 2.75rem !important;
    }
    
    /* Password Strength Meter */
    .password-strength {
        height: 4px;
        border-radius: 2px;
        background: #e0e0e0;
        margin-top: 0.4rem;
        overflow: hidden;
    }
    
    .password-strength-bar {
        height: 100%;
        width: 0%;
        transition: all 0.3s;
    }
    
    .strength-weak { width: 33%; background: #dc3545; }
    .strength-medium { width: 66%; background: #ffc107; }
    .strength-strong { width: 100%; background: #28a745; }
    
    #strengthText {
        display: block;
        margin-top: 0.25rem;
        font-size: var(--font-xs);
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }
    
    .loading-spinner {
        display: inline-block;
        width: 1rem;
        height: 1rem;
        border: 2px solid rgba(255,255,255,0.3);
        border-top-color: white;
        border-radius: 50%;
        animation: spin 0.6s linear infinite;
    }
    
    @keyframes spin {
        to { transform: rotate(360deg); }
    }
    
    /* Modal Styles */
    .modal-header {
        background: linear-gradient(135deg, #087fc2 0%, #0669a0 100%);
        color: white;
        border-bottom: none;
    }

    .modal-title {
        font-size: var(--font-lg);
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }
    
    .modal-header .btn-close {
        filter: brightness(0) invert(1);
    }

    .modal-body {
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

    .modal-body p, .modal-body li {
        font-size: var(--font-sm);
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }
    
    .contact-method {
        background: #f8f9fa;
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 1rem;
        border-left: 4px solid #087fc2;
    }
    
    .contact-method h6 {
        color: #087fc2;
        font-weight: 600;
        margin-bottom: 0.5rem;
        font-size: var(--font-sm);
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

    .contact-method p {
        font-size: var(--font-sm);
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }
    
    .contact-method a {
        color: #0669a0;
        text-decoration: none;
        font-weight: 500;
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }
    
    .contact-method a:hover {
        text-decoration: underline;
    }

    .contact-method small {
        font-size: var(--font-xs);
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

    .card-body h2 {
        font-size: var(--font-xl);
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

    .card-body p {
        font-size: var(--font-sm);
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

    .form-text {
        font-size: var(--font-xs);
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

    small.form-text {
        font-size: var(--font-xs);
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

    .alert {
        font-size: var(--font-sm);
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

    .alert li {
        font-size: var(--font-sm);
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

    .form-check-label {
        font-size: var(--font-sm);
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

    .form-check-label a {
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

    .btn {
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

    .btn-primary {
        font-size: var(--font-sm);
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

    .btn-secondary {
        font-size: var(--font-sm);
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

    #subcategoryLoader {
        font-size: var(--font-xs);
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

    .text-muted {
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

    .mb-3 {
        margin-bottom: 0.75rem !important;
    }

    .mb-4 {
        margin-bottom: 1rem !important;
    }

    /* Eye icon hover effect */
    span[onclick*="togglePassword"]:hover i {
        color: #087fc2 !important;
    }

    /* Responsive */
    @media (max-width: 991.98px) {
        .left-content-section {
            min-height: auto;
            margin-bottom: 1rem;
            padding: 1.25rem;
        }

        .left-content-section h1 {
            font-size: var(--font-xl);
        }

        .left-content-section h2 {
            font-size: var(--font-lg);
            margin-top: 0.75rem;
        }

        .client-logo-item {
            min-width: 130px;
            height: 65px;
        }

        .looking-for-grid {
            grid-template-columns: repeat(2, 1fr);
        }

        .client-logos-slider {
            height: 70px;
        }
    }

    @media (max-width: 768px) {
        .sales-contact-info {
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .sales-banner {
            padding: 0.875rem;
        }
        
        .sales-banner h5 {
            font-size: var(--font-sm);
        }
        
        .btn-close-banner {
            width: 24px;
            height: 24px;
        }

        .signup-container {
            padding: 0.5rem 0;
        }

        .card-body {
            padding: 1rem !important;
        }

        .card-body h2 {
            font-size: var(--font-lg);
        }

        .client-logos-slider {
            height: 65px;
        }

        .client-logo-item {
            min-width: 120px;
            height: 60px;
        }

        .looking-for-grid {
            grid-template-columns: 1fr;
        }

        .left-content-section {
            padding: 1rem;
        }
    }

    @media (max-width: 480px) {
        .client-logo-item {
            min-width: 110px;
            height: 55px;
        }

        .client-logos-slider {
            height: 60px;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid signup-container">
    <div class="container">
        <div class="row g-3">
            <!-- Left Side - Content Section -->
            <div class="col-lg-6">
                <div class="left-content-section">
                    <h1 class="text-white" style="font-size:29px">
                        Unlock the Future of employee training with CHRP‑INDIA
                    </h1>
                    <p>
                        Explore immersive XR training, interactive demos, and next-gen eLearning solutions - tailored for your business.
                    </p>

                    <ul class="feature-list">
                        <li>
                            <i class="fas fa-check"></i>
                            <span>Personalized eLearning + XR demo access</span>
                        </li>
                        <li>
                            <i class="fas fa-check"></i>
                            <span>Built for enterprises, educators & L&D leaders</span>
                        </li>
                        <li>
                            <i class="fas fa-check"></i>
                            <span>Schedule a 1‑on‑1 live session with our experts</span>
                        </li>
                    </ul>

                    <!-- ✅ Trusted Clients Section - REAL LOGO IMAGES -->
                    <div class="clients-section">
                        <h3>Trusted by Leading Companies</h3>
                        <div class="client-logos-slider">
                            <div class="client-logos-track">
                                <!-- First set of logos -->
                                <div class="client-logo-item">
                                    <img src="{% static 'images/client_logos/epiroc.png' %}" alt="Epiroc">
                                </div>
                                <div class="client-logo-item">
                                    <img src="{% static 'images/client_logos/hero.png' %}" alt="Hero">
                                </div>
                                <div class="client-logo-item">
                                    <img src="{% static 'images/client_logos/jcb.png' %}" alt="JCB">
                                </div>
                                <div class="client-logo-item">
                                    <img src="{% static 'images/client_logos/lennox.png' %}" alt="Lennox">
                                </div>
                                <div class="client-logo-item">
                                    <img src="{% static 'images/client_logos/mcl.png' %}" alt="MCL">
                                </div>
                                <div class="client-logo-item">
                                    <img src="{% static 'images/client_logos/schneider.png' %}" alt="Schneider">
                                </div>
                                <div class="client-logo-item">
                                    <img src="{% static 'images/client_logos/tata.png' %}" alt="Tata">
                                </div>
                                <div class="client-logo-item">
                                    <img src="{% static 'images/client_logos/vedanta.png' %}" alt="Vedanta">
                                </div>
                                
                                <!-- Duplicate set for seamless loop -->
                                <div class="client-logo-item">
                                    <img src="{% static 'images/client_logos/epiroc.png' %}" alt="Epiroc">
                                </div>
                                <div class="client-logo-item">
                                    <img src="{% static 'images/client_logos/hero.png' %}" alt="Hero">
                                </div>
                                <div class="client-logo-item">
                                    <img src="{% static 'images/client_logos/jcb.png' %}" alt="JCB">
                                </div>
                                <div class="client-logo-item">
                                    <img src="{% static 'images/client_logos/lennox.png' %}" alt="Lennox">
                                </div>
                                <div class="client-logo-item">
                                    <img src="{% static 'images/client_logos/mcl.png' %}" alt="MCL">
                                </div>
                                <div class="client-logo-item">
                                    <img src="{% static 'images/client_logos/schneider.png' %}" alt="Schneider">
                                </div>
                                <div class="client-logo-item">
                                    <img src="{% static 'images/client_logos/tata.png' %}" alt="Tata">
                                </div>
                                <div class="client-logo-item">
                                    <img src="{% static 'images/client_logos/vedanta.png' %}" alt="Vedanta">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="looking-for-section">
                        <h3 class="text-white">Need Quick Access? Contact Our Sales Team</h3>
                        <p>
                            For enterprise solutions, bulk licenses, or immediate account activation, our sales team is here to help you get started faster.
                        </p>  

                        <div class="sales-contact-info">
                            <div class="sales-contact-item">
                                <i class="fas fa-phone-alt"></i>
                                <a href="tel:+918008987948" class="text-decoration-none">
                                    +91 8008987948
                                </a>
                            </div>
                            <div class="sales-contact-item">
                                <i class="fas fa-envelope"></i>
                                <a href="mailto:reach@chrp-india.com" class="text-decoration-none">
                                    reach@chrp-india.com
                                </a>
                            </div>
                        </div>
                        
                        {% comment %} <button type="button" class="btn btn-contact-sales mt-2" data-bs-toggle="modal" data-bs-target="#salesModal">
                            <i class="fas fa-comments"></i>
                            Contact Sales Team
                        </button>  {% endcomment %}
                    </div>

                </div>
            </div>

            <!-- Right Side - Signup Form -->
            <div class="col-lg-6">
               
                <!-- Signup Card -->
                <div class="card signup-card">
                    <div class="card-body p-3">
                        <div class="text-center mb-3">
                            <h2 class="fw-bold text-primary">Sign Up</h2>
                            <p class="text-muted">Discover all-in-one eLearning solutions to help your business grow</p>
                        </div>

                        <form method="post" id="signupForm" novalidate>
                            {% csrf_token %}
                            
                            {% if form.errors %}
                                <div class="alert alert-danger alert-dismissible fade show">
                                    <strong>Please correct the following errors:</strong>
                                    <ul class="mb-0 mt-2">
                                        {% for field, errors in form.errors.items %}
                                            {% for error in errors %}
                                                <li>{{ error }}</li>
                                            {% endfor %}
                                        {% endfor %}
                                    </ul>
                                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                                </div>
                            {% endif %}

                            <!-- Name Fields -->
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">First Name <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" name="first_name" id="firstName" 
                                           required value="{{ form.first_name.value|default:'' }}">
                                    <div class="invalid-feedback">Please enter your first name</div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Last Name <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" name="last_name" id="lastName" 
                                           required value="{{ form.last_name.value|default:'' }}">
                                    <div class="invalid-feedback">Please enter your last name</div>
                                </div>
                            </div>

                            <!-- Email -->
                            <div class="mb-3">
                                <label class="form-label">Business Email <span class="text-danger">*</span></label>
                                <input type="email" class="form-control" name="email" id="emailField" 
                                       required value="{{ form.email.value|default:'' }}">
                                <div class="invalid-feedback" id="emailError">Please enter a valid business email</div>
                                <small class="form-text text-muted">
                                    <i class="fas fa-info-circle me-1"></i>
                                    Use your business email address (personal emails not allowed)
                                </small>
                            </div>

                            <!-- Mobile -->
<!-- Mobile -->
<div class="mb-3">
    <label class="form-label">Mobile Number <span class="text-danger">*</span></label>
    <div class="input-group">
        <select class="form-select" name="country_code" id="countryCode" style="max-width: 150px;">
            {% for code, label in form.fields.country_code.choices %}
                <option value="{{ code }}" {% if code == '+91' %}selected{% endif %}>
                    {{ label }}
                </option>
            {% endfor %}
        </select>
        <input type="tel" 
               class="form-control" 
               name="mobile" 
               id="mobileField" 
               required 
               placeholder="9876543210"
               maxlength="15"
               inputmode="numeric"
               autocomplete="tel"
               value="{{ form.mobile.value|default:'' }}">
    </div>
    <div class="invalid-feedback" id="mobileError">Please enter a valid mobile number</div>
    <small class="form-text text-muted">
        <i class="fas fa-info-circle me-1"></i>
        <span id="mobileHint">Indian mobile must be 10 digits starting with 6-9</span>
    </small>
</div>

                            <!-- Job & Organization -->
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Job Title <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" name="job_title" id="jobTitle" 
                                           required value="{{ form.job_title.value|default:'' }}">
                                    <div class="invalid-feedback">Please enter your job title</div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Organization <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" name="organization" id="organization" 
                                           required value="{{ form.organization.value|default:'' }}">
                                    <div class="invalid-feedback">Please enter your organization name</div>
                                </div>
                            </div>

                            <!-- Business Category -->
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Business Category <span class="text-danger">*</span></label>
                                    <select class="form-select" name="business_category" id="categorySelect" required>
                                        <option value="">Select category...</option>
                                        {% for category in form.fields.business_category.queryset %}
                                            <option value="{{ category.id }}"
                                                    {% if form.business_category.value|stringformat:"s" == category.id|stringformat:"s" %}selected{% endif %}>
                                                {% if category.icon %}{{ category.icon }} {% endif %}{{ category.name }}
                                            </option>
                                        {% endfor %}
                                    </select>
                                    <div class="invalid-feedback">Please select a business category</div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Subcategory <small class="text-muted">(Optional)</small></label>
                                    <select class="form-select" name="business_subcategory" id="subcategorySelect" disabled>
                                        <option value="">Select category first...</option>
                                    </select>
                                    <div id="subcategoryLoader" class="text-muted small mt-1" style="display:none;">
                                        <span class="loading-spinner"></span> Loading...
                                    </div>
                                </div>
                            </div>

                            <!-- Password - WITH EYE TOGGLE -->
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Password <span class="text-danger">*</span></label>
                                    <div class="position-relative">
                                        <input type="password" class="form-control" name="password1" id="password1" 
                                            required minlength="8" style="padding-right: 2.75rem;">
                                        <span onclick="togglePassword('password1', this)" 
                                            style="position: absolute; right: 8px; top: 38%; transform: translateY(-50%); cursor: pointer; font-size: 18px; color: #6c757d; transition: color 0.2s; z-index: 10;">
                                            <i class="fas fa-eye"></i>
                                        </span>
                                    </div>
                                    <div class="password-strength">
                                        <div class="password-strength-bar" id="strengthBar"></div>
                                    </div>
                                    <small class="text-muted" id="strengthText">
                                        Min 8 characters. Use uppercase, lowercase, numbers & special characters for a strong password
                                    </small>
                                    <div class="invalid-feedback">Password must be at least 8 characters</div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Confirm Password <span class="text-danger">*</span></label>
                                    <div class="position-relative">
                                        <input type="password" class="form-control" name="password2" id="password2" 
                                            required style="padding-right: 2.75rem;">
                                        <span onclick="togglePassword('password2', this)" 
                                            style="position: absolute; right: 8px; top: 38%; transform: translateY(-50%); cursor: pointer; font-size: 18px; color: #6c757d; transition: color 0.2s; z-index: 10;">
                                            <i class="fas fa-eye"></i>
                                        </span>
                                    </div>
                                    <div class="invalid-feedback" id="password2Error">Passwords must match</div>
                                    <div class="valid-feedback">
                                        <i class="fas fa-check-circle me-1"></i>Passwords match
                                    </div>
                                </div>
                            </div>

                            <!-- Referral -->
                            <div class="mb-3">
                                <label class="form-label">How did you find us? <small class="text-muted">(Optional)</small></label>
                                <select class="form-select" name="referral_source" id="referralSource">
                                    {% comment %} <option value="">Select source...</option> {% endcomment %}
                                    {% for value, label in form.fields.referral_source.choices %}
                                        {% if value %}
                                            <option value="{{ value }}"
                                                    {% if form.referral_source.value == value %}selected{% endif %}>
                                                {{ label }}
                                            </option>
                                        {% endif %}
                                    {% endfor %}
                                </select>
                            </div>

                            <!-- Terms -->
                            <div class="mb-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" required id="terms">
                                    <label class="form-check-label" for="terms">
                                        I agree to the <a href="#" target="_blank">Terms of Service</a> and 
                                        <a href="#" target="_blank">Privacy Policy</a> <span class="text-danger">*</span>
                                    </label>
                                    <div class="invalid-feedback">You must agree to the terms and conditions</div>
                                </div>
                            </div>

                            <!-- Submit -->
                            <button type="submit" class="btn btn-primary w-100 py-2 mb-3" id="submitBtn">
                                <i class="fas fa-user-plus me-2"></i>Sign Up
                            </button>
                        </form>

                        <hr class="my-3">
                        
                        <div class="text-center">
                            <p class="text-muted mb-0">
                                Already have an account? 
                                <a href="{% url 'accounts:signin' %}" class="text-decoration-none fw-bold">Sign In</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
// ✅ Password Toggle Function (outside DOMContentLoaded)
function togglePassword(fieldId, iconElement) {
    const passwordField = document.getElementById(fieldId);
    const icon = iconElement.querySelector('i');
    
    if (passwordField.type === 'password') {
        passwordField.type = 'text';
        icon.classList.remove('fa-eye');
        icon.classList.add('fa-eye-slash');
    } else {
        passwordField.type = 'password';
        icon.classList.remove('fa-eye-slash');
        icon.classList.add('fa-eye');
    }
}

// ✅ Main Application Logic
document.addEventListener('DOMContentLoaded', function() {
    // ========================================
    // ELEMENT REFERENCES
    // ========================================
    const form = document.getElementById('signupForm');
    const submitBtn = document.getElementById('submitBtn');
    const categorySelect = document.getElementById('categorySelect');
    const subcategorySelect = document.getElementById('subcategorySelect');
    const password1 = document.getElementById('password1');
    const password2 = document.getElementById('password2');
    const strengthBar = document.getElementById('strengthBar');
    const strengthText = document.getElementById('strengthText');
    const emailField = document.getElementById('emailField');
    const mobileField = document.getElementById('mobileField');
    const countryCode = document.getElementById('countryCode');
    const termsCheckbox = document.getElementById('terms');
    
    // ========================================
    // CONFIGURATION
    // ========================================
    const blockedDomains = [
        'gmail.com', 'yahoo.com', 'hotmail.com', 'outlook.com', 
        'ymail.com', 'aol.com', 'icloud.com', 'live.com', 
        'rediffmail.com', 'protonmail.com'
    ];
    
    // ✅ Country-specific mobile validation rules
    const mobileRules = {
        '+91': { 
            minLength: 10, 
            maxLength: 10, 
            pattern: /^[6-9]\d{9}$/, 
            placeholder: '9876543210',
            message: 'Indian mobile must be 10 digits starting with 6-9'
        },
        '+1': { 
            minLength: 10, 
            maxLength: 10, 
            pattern: /^\d{10}$/, 
            placeholder: '2025551234',
            message: 'US/Canada mobile must be 10 digits'
        },
        '+44': { 
            minLength: 10, 
            maxLength: 10, 
            pattern: /^[1-9]\d{9}$/, 
            placeholder: '7400123456',
            message: 'UK mobile must be 10 digits'
        },
        '+86': { 
            minLength: 11, 
            maxLength: 11, 
            pattern: /^1[3-9]\d{9}$/, 
            placeholder: '13800138000',
            message: 'Chinese mobile must be 11 digits starting with 1'
        },
        '+61': { 
            minLength: 9, 
            maxLength: 9, 
            pattern: /^4\d{8}$/, 
            placeholder: '412345678',
            message: 'Australian mobile must be 9 digits starting with 4'
        },
        '+971': { 
            minLength: 9, 
            maxLength: 9, 
            pattern: /^5\d{8}$/, 
            placeholder: '501234567',
            message: 'UAE mobile must be 9 digits starting with 5'
        },
        '+966': { 
            minLength: 9, 
            maxLength: 9, 
            pattern: /^5\d{8}$/, 
            placeholder: '501234567',
            message: 'Saudi mobile must be 9 digits starting with 5'
        },
        '+65': { 
            minLength: 8, 
            maxLength: 8, 
            pattern: /^[89]\d{7}$/, 
            placeholder: '81234567',
            message: 'Singapore mobile must be 8 digits starting with 8/9'
        },
        '+81': { 
            minLength: 10, 
            maxLength: 10, 
            pattern: /^[7-9]\d{8,9}$/, 
            placeholder: '9012345678',
            message: 'Japanese mobile must be 9-10 digits'
        },
        '+92': { 
            minLength: 10, 
            maxLength: 10, 
            pattern: /^3\d{9}$/, 
            placeholder: '3001234567',
            message: 'Pakistani mobile must be 10 digits starting with 3'
        },
        // Default for other countries
        'default': { 
            minLength: 7, 
            maxLength: 15, 
            pattern: /^\d{7,15}$/, 
            placeholder: '1234567890',
            message: 'Mobile must be 7-15 digits'
        }
    };
    
    // ========================================
    // HELPER FUNCTIONS
    // ========================================
    
    // Get current country mobile rule
    function getCurrentMobileRule() {
        const selected = countryCode.value;
        return mobileRules[selected] || mobileRules['default'];
    }
    
    // ========================================
    // SALES BANNER DISMISS
    // ========================================
    const closeSalesBannerBtn = document.getElementById('closeSalesBanner');
    const salesBanner = document.getElementById('salesBanner');
    
    if (closeSalesBannerBtn && salesBanner) {
        closeSalesBannerBtn.addEventListener('click', function() {
            salesBanner.classList.add('hiding');
            setTimeout(() => {
                salesBanner.classList.add('dismissed');
                localStorage.setItem('salesBannerDismissed', 'true');
            }, 300);
        });
        
        // Check if already dismissed
        if (localStorage.getItem('salesBannerDismissed') === 'true') {
            salesBanner.classList.add('dismissed');
        }
    }
    
    // ========================================
    // FORM SUBMIT HANDLER
    // ========================================
    form.addEventListener('submit', function(e) {
        e.preventDefault();
        e.stopPropagation();
        handleFormSubmit();
        return false;
    });
    
    // ========================================
    // TEXT INPUT VALIDATION
    // ========================================
    const textInputs = form.querySelectorAll('input[type="text"]');
    textInputs.forEach(input => {
        input.addEventListener('blur', function() {
            if (this.hasAttribute('required')) {
                if (!this.value.trim()) {
                    this.classList.add('is-invalid');
                    this.classList.remove('is-valid');
                } else {
                    this.classList.remove('is-invalid');
                    this.classList.add('is-valid');
                }
            }
        });
        
        input.addEventListener('input', function() {
            if (this.classList.contains('is-invalid') && this.value.trim()) {
                this.classList.remove('is-invalid');
                this.classList.add('is-valid');
            }
        });
    });
    
    // ========================================
    // EMAIL VALIDATION
    // ========================================
    function validateEmail() {
        const email = emailField.value.trim();
        const emailError = document.getElementById('emailError');
        
        if (!email) {
            emailField.classList.add('is-invalid');
            emailField.classList.remove('is-valid');
            emailError.textContent = 'Email is required';
            return false;
        }
        
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
            emailField.classList.add('is-invalid');
            emailField.classList.remove('is-valid');
            emailError.textContent = 'Please enter a valid email address';
            return false;
        }
        
        const domain = email.split('@')[1]?.toLowerCase();
        if (blockedDomains.includes(domain)) {
            emailField.classList.add('is-invalid');
            emailField.classList.remove('is-valid');
            emailError.textContent = `Business email required. Personal domains (${domain}) not allowed`;
            return false;
        }
        
        emailField.classList.remove('is-invalid');
        emailField.classList.add('is-valid');
        return true;
    }
    
    emailField.addEventListener('blur', validateEmail);
    emailField.addEventListener('input', function() {
        if (this.classList.contains('is-invalid')) {
            validateEmail();
        }
    });
    
    // ========================================
    // MOBILE NUMBER VALIDATION
    // ========================================
    
    // Update placeholder and hints when country changes
    countryCode.addEventListener('change', function() {
        const rule = getCurrentMobileRule();
        
        // Update input attributes
        mobileField.placeholder = rule.placeholder;
        mobileField.maxLength = rule.maxLength;
        
        // Update hint text
        const hintElement = document.getElementById('mobileHint');
        if (hintElement) {
            hintElement.textContent = rule.message;
        }
        
        // Clear validation state
        mobileField.classList.remove('is-valid', 'is-invalid');
        
        // Re-validate if field has value
        if (mobileField.value.trim()) {
            validateMobile();
        }
    });
    
    // Validate mobile number
    function validateMobile() {
        const mobile = mobileField.value.replace(/\D/g, ''); // Remove non-digits
        const rule = getCurrentMobileRule();
        const errorDiv = document.getElementById('mobileError');
        
        if (!mobile) {
            mobileField.classList.remove('is-valid', 'is-invalid');
            if (errorDiv) errorDiv.textContent = 'Mobile number is required';
            return false;
        }
        
        // Check length
        if (mobile.length < rule.minLength || mobile.length > rule.maxLength) {
            mobileField.classList.add('is-invalid');
            mobileField.classList.remove('is-valid');
            if (errorDiv) errorDiv.textContent = rule.message;
            return false;
        }
        
        // Check pattern
        if (!rule.pattern.test(mobile)) {
            mobileField.classList.add('is-invalid');
            mobileField.classList.remove('is-valid');
            if (errorDiv) errorDiv.textContent = rule.message;
            return false;
        }
        
        // Valid
        mobileField.classList.remove('is-invalid');
        mobileField.classList.add('is-valid');
        if (errorDiv) errorDiv.textContent = '';
        return true;
    }
    
    // Restrict input to digits only
    mobileField.addEventListener('input', function() {
        const rule = getCurrentMobileRule();
        
        // Remove non-digits
        this.value = this.value.replace(/\D/g, '');
        
        // Enforce max length
        if (this.value.length > rule.maxLength) {
            this.value = this.value.slice(0, rule.maxLength);
        }
        
        // Auto-validate when reaching minimum length
        if (this.value.length >= rule.minLength) {
            validateMobile();
        } else if (this.classList.contains('is-invalid') || this.classList.contains('is-valid')) {
            this.classList.remove('is-valid', 'is-invalid');
        }
    });
    
    // Validate on blur
    mobileField.addEventListener('blur', function() {
        if (this.value.trim()) {
            validateMobile();
        }
    });
    
    // ========================================
    // PASSWORD STRENGTH CHECKER
    // ========================================
    password1.addEventListener('input', function() {
        const password = this.value;
        let strength = 0;
        
        strengthBar.className = 'password-strength-bar';
        
        if (password.length >= 8) strength++;
        if (/[A-Z]/.test(password)) strength++;
        if (/[0-9]/.test(password)) strength++;
        if (/[^A-Za-z0-9]/.test(password)) strength++;
        
        if (password.length === 0) {
            strengthText.textContent = 'Min 8 characters. Use uppercase, lowercase, numbers & special characters for a strong password';
            strengthText.className = 'text-muted';
        } else if (strength <= 1) {
            strengthBar.classList.add('strength-weak');
            strengthText.textContent = 'Weak password - Add uppercase letters, numbers & special characters';
            strengthText.className = 'text-danger';
        } else if (strength === 2) {
            strengthBar.classList.add('strength-medium');
            strengthText.textContent = 'Medium password - Add more variety for better security';
            strengthText.className = 'text-warning';
        } else {
            strengthBar.classList.add('strength-strong');
            strengthText.textContent = 'Strong password ✓';
            strengthText.className = 'text-success';
        }
        
        // Re-validate password match if password2 has value
        if (password2.value) {
            validatePasswordMatch();
        }
    });
    
    password1.addEventListener('blur', function() {
        if (this.value.length > 0 && this.value.length < 8) {
            this.classList.add('is-invalid');
            this.classList.remove('is-valid');
        } else if (this.value.length >= 8) {
            this.classList.remove('is-invalid');
            this.classList.add('is-valid');
        }
    });
    
    // ========================================
    // PASSWORD MATCH VALIDATION
    // ========================================
    function validatePasswordMatch() {
        const pass1 = password1.value;
        const pass2 = password2.value;
        const errorDiv = document.getElementById('password2Error');
        
        if (!pass2) {
            password2.classList.remove('is-invalid', 'is-valid');
            return false;
        }
        
        if (pass1.length < 8) {
            password2.classList.add('is-invalid');
            password2.classList.remove('is-valid');
            errorDiv.textContent = 'Password must be at least 8 characters';
            return false;
        }
        
        if (pass2 !== pass1) {
            password2.classList.add('is-invalid');
            password2.classList.remove('is-valid');
            errorDiv.textContent = 'Passwords do not match';
            return false;
        }
        
        password2.classList.remove('is-invalid');
        password2.classList.add('is-valid');
        return true;
    }
    
    password2.addEventListener('input', validatePasswordMatch);
    password2.addEventListener('blur', validatePasswordMatch);
    
    // ========================================
    // BUSINESS CATEGORY & SUBCATEGORY
    // ========================================
    // ========================================
// BUSINESS CATEGORY & SUBCATEGORY
// ========================================
categorySelect.addEventListener('change', function() {
    const categoryId = this.value;
    
    if (!categoryId) {
        this.classList.add('is-invalid');
        this.classList.remove('is-valid');
        subcategorySelect.innerHTML = '<option value="">Select category first...</option>';
        subcategorySelect.disabled = true;
        return;
    }
    
    this.classList.remove('is-invalid');
    this.classList.add('is-valid');
    
    subcategorySelect.disabled = true;
    const loader = document.getElementById('subcategoryLoader');
    if (loader) loader.style.display = 'block';
    
    // ✅ FIXED: Use Django URL template tag for correct path
    const subcategoryUrl = "{% url 'accounts:get_subcategories' %}";
    
    fetch(`${subcategoryUrl}?category_id=${categoryId}`)
        .then(res => res.json())
        .then(data => {
            subcategorySelect.innerHTML = '<option value="">Select subcategory</option>';
            
            if (data.success && data.subcategories && data.subcategories.length > 0) {
                data.subcategories.forEach(sub => {
                    subcategorySelect.innerHTML += `<option value="${sub.id}">${sub.name}</option>`;
                });
            }
            
            subcategorySelect.disabled = false;
            if (loader) loader.style.display = 'none';
        })
        .catch((error) => {
            console.error('Subcategory loading error:', error);
            subcategorySelect.innerHTML = '<option value="">Error loading subcategories</option>';
            if (loader) loader.style.display = 'none';
        });
});
    
    // ========================================
    // TERMS CHECKBOX VALIDATION
    // ========================================
    termsCheckbox.addEventListener('change', function() {
        if (this.checked) {
            this.classList.remove('is-invalid');
            const errorMsg = this.closest('.form-check').querySelector('.invalid-feedback');
            if (errorMsg) errorMsg.style.display = 'none';
        }
    });
    
    // ========================================
    // FORM SUBMISSION HANDLER
    // ========================================
    function handleFormSubmit() {
        let isValid = true;
        let errors = [];
        
        // First name validation
        const firstName = form.querySelector('[name="first_name"]');
        if (!firstName.value.trim()) {
            firstName.classList.add('is-invalid');
            errors.push('First name is required');
            isValid = false;
        }
        
        // Last name validation
        const lastName = form.querySelector('[name="last_name"]');
        if (!lastName.value.trim()) {
            lastName.classList.add('is-invalid');
            errors.push('Last name is required');
            isValid = false;
        }
        
        // Email validation
        if (!validateEmail()) {
            errors.push('Valid business email is required');
            isValid = false;
        }
        
        // Mobile validation
        if (!validateMobile()) {
            const rule = getCurrentMobileRule();
            errors.push(rule.message);
            isValid = false;
        }
        
        // Job title validation
        const jobTitle = form.querySelector('[name="job_title"]');
        if (!jobTitle.value.trim()) {
            jobTitle.classList.add('is-invalid');
            errors.push('Job title is required');
            isValid = false;
        }
        
        // Organization validation
        const organization = form.querySelector('[name="organization"]');
        if (!organization.value.trim()) {
            organization.classList.add('is-invalid');
            errors.push('Organization is required');
            isValid = false;
        }
        
        // Category validation
        if (!categorySelect.value) {
            categorySelect.classList.add('is-invalid');
            errors.push('Business category is required');
            isValid = false;
        }
        
        // Password validation
        if (password1.value.length < 8) {
            password1.classList.add('is-invalid');
            errors.push('Password must be at least 8 characters');
            isValid = false;
        }
        
        // Password match validation
        if (!validatePasswordMatch()) {
            errors.push('Passwords must match');
            isValid = false;
        }
        
        // Terms checkbox validation
        if (!termsCheckbox.checked) {
            termsCheckbox.classList.add('is-invalid');
            const errorMsg = termsCheckbox.closest('.form-check').querySelector('.invalid-feedback');
            if (errorMsg) errorMsg.style.display = 'block';
            errors.push('You must agree to terms and conditions');
            isValid = false;
        }
        
        if (!isValid) {
            alert('Please fix the following errors:\n\n• ' + errors.join('\n• '));
            
            const firstError = form.querySelector('.is-invalid');
            if (firstError) {
                firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                firstError.focus();
            }
            
            submitBtn.disabled = false;
            submitBtn.innerHTML = '<i class="fas fa-user-plus me-2"></i>Sign Up';
            return;
        }
        
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<span class="loading-spinner me-2"></span>Sending verification code...';
        form.submit();
    }
});
</script>
{% endblock %}