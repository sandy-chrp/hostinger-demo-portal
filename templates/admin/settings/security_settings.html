{% extends 'admin/base.html' %}

{% block admin_title %}Security Settings{% endblock %}
{% block page_title %}Security Configuration{% endblock %}

{% block admin_content %}
<!-- Page Header -->
<div class="d-flex justify-content-between align-items-start mb-4 flex-wrap gap-3">
    <div>
        <h4 class="mb-1" style="font-weight: 500; color: #2c3e50;">Security Configuration</h4>
        <p class="text-muted mb-0" style="font-size: 0.875rem;">Manage password policies, session timeouts, and login security</p>
    </div>
    <a href="{% url 'core:admin_settings' %}" class="btn btn-outline-secondary">
        <i class="fas fa-arrow-left me-1"></i>Back
    </a>
</div>

<div class="row">
    <div class="col-lg-8 mx-auto">
        <form method="post">
            {% csrf_token %}
            
            <!-- Password Requirements -->
            <div class="admin-card mb-4">
                <div class="admin-card-header">
                    <h5 class="mb-0" style="font-weight: 500; font-size: 1rem;">
                        <i class="fas fa-key me-2"></i>Password Requirements
                    </h5>
                </div>
                <div class="admin-card-body">
                    <div class="row">
                        <!-- Min Length -->
                        <div class="col-md-6 mb-3">
                            <label class="form-label" style="font-size: 0.875rem; font-weight: 500;">
                                Minimum Password Length <span class="text-danger">*</span>
                            </label>
                            <input type="number" 
                                   name="password_min_length" 
                                   class="form-control" 
                                   style="font-size: 0.938rem; height: 38px;"
                                   value="{{ security_settings.password_min_length }}" 
                                   min="6" 
                                   max="20"
                                   required>
                            <small class="text-muted" style="font-size: 0.813rem;">
                                <i class="fas fa-ruler me-1"></i>Minimum 6, maximum 20 characters
                            </small>
                        </div>
                        
                        <!-- Password Rules -->
                        <div class="col-md-6 mb-3">
                            <label class="form-label" style="font-size: 0.875rem; font-weight: 500;">
                                Additional Requirements
                            </label>
                            <div class="password-rules">
                                <div class="form-check mb-2">
                                    <input class="form-check-input" 
                                           type="checkbox" 
                                           name="password_require_uppercase" 
                                           id="requireUpper"
                                           {% if security_settings.password_require_uppercase %}checked{% endif %}>
                                    <label class="form-check-label" for="requireUpper" style="font-size: 0.875rem;">
                                        <i class="fas fa-font me-1"></i>Require uppercase letters (A-Z)
                                    </label>
                                </div>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" 
                                           type="checkbox" 
                                           name="password_require_numbers" 
                                           id="requireNumbers"
                                           {% if security_settings.password_require_numbers %}checked{% endif %}>
                                    <label class="form-check-label" for="requireNumbers" style="font-size: 0.875rem;">
                                        <i class="fas fa-hashtag me-1"></i>Require numbers (0-9)
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" 
                                           type="checkbox" 
                                           name="password_require_special" 
                                           id="requireSpecial"
                                           {% if security_settings.password_require_special %}checked{% endif %}>
                                    <label class="form-check-label" for="requireSpecial" style="font-size: 0.875rem;">
                                        <i class="fas fa-asterisk me-1"></i>Require special characters (!@#$%)
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Session Settings -->
            <div class="admin-card mb-4">
                <div class="admin-card-header">
                    <h5 class="mb-0" style="font-weight: 500; font-size: 1rem;">
                        <i class="fas fa-clock me-2"></i>Session Settings
                    </h5>
                </div>
                <div class="admin-card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <label class="form-label" style="font-size: 0.875rem; font-weight: 500;">
                                Session Timeout (minutes) <span class="text-danger">*</span>
                            </label>
                            <input type="number" 
                                   name="session_timeout" 
                                   class="form-control" 
                                   style="font-size: 0.938rem; height: 38px;"
                                   value="{{ security_settings.session_timeout }}" 
                                   min="5"
                                   required>
                            <small class="text-muted" style="font-size: 0.813rem;">
                                <i class="fas fa-hourglass-half me-1"></i>Time before inactive sessions expire (minimum 5 minutes)
                            </small>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Login Security -->
            <div class="admin-card mb-4">
                <div class="admin-card-header">
                    <h5 class="mb-0" style="font-weight: 500; font-size: 1rem;">
                        <i class="fas fa-user-lock me-2"></i>Login Security
                    </h5>
                </div>
                <div class="admin-card-body">
                    <div class="row">
                        <!-- Max Login Attempts -->
                        <div class="col-md-6 mb-3">
                            <label class="form-label" style="font-size: 0.875rem; font-weight: 500;">
                                Max Login Attempts <span class="text-danger">*</span>
                            </label>
                            <input type="number" 
                                   name="max_login_attempts" 
                                   class="form-control" 
                                   style="font-size: 0.938rem; height: 38px;"
                                   value="{{ security_settings.max_login_attempts }}" 
                                   min="3" 
                                   max="10"
                                   required>
                            <small class="text-muted" style="font-size: 0.813rem;">
                                <i class="fas fa-exclamation-circle me-1"></i>Failed attempts before account lockout (3-10)
                            </small>
                        </div>
                        
                        <!-- Lockout Duration -->
                        <div class="col-md-6 mb-3">
                            <label class="form-label" style="font-size: 0.875rem; font-weight: 500;">
                                Account Lockout Duration (minutes) <span class="text-danger">*</span>
                            </label>
                            <input type="number" 
                                   name="lockout_duration" 
                                   class="form-control" 
                                   style="font-size: 0.938rem; height: 38px;"
                                   value="{{ security_settings.lockout_duration }}" 
                                   min="5"
                                   required>
                            <small class="text-muted" style="font-size: 0.813rem;">
                                <i class="fas fa-lock me-1"></i>How long accounts remain locked (minimum 5 minutes)
                            </small>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Warning Alert -->
            <div class="alert alert-warning mb-4" style="border-left: 4px solid #ffc107; background: #fff8e1; border-radius: 8px;">
                <div class="d-flex align-items-start gap-2">
                    <i class="fas fa-exclamation-triangle" style="font-size: 1.125rem; color: #856404; margin-top: 0.125rem;"></i>
                    <div style="font-size: 0.875rem; color: #856404;">
                        <strong style="font-weight: 600;">Important:</strong> Changes to security settings will affect all users immediately. Please ensure you understand the impact before saving.
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="admin-card">
                <div class="admin-card-body">
                    <div class="d-flex gap-2 justify-content-end">
                        <a href="{% url 'core:admin_settings' %}" class="btn btn-secondary">
                            <i class="fas fa-times me-1"></i>Cancel
                        </a>
                        <button type="submit" class="btn btn-warning">
                            <i class="fas fa-save me-1"></i>Update Security Settings
                        </button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

<style>
    .password-rules {
        padding: 0.75rem;
        background: #f8f9fa;
        border-radius: 6px;
        border: 1px solid #e9ecef;
    }
    
    .password-rules .form-check {
        padding-left: 0;
    }
    
    .password-rules .form-check-input {
        margin-right: 0.5rem;
    }
</style>
{% endblock %}